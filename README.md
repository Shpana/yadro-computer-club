# yadro-computer-club


## Обзор
Решение тестового задания в Yadro: прототип системы, следящей за работой компьютерного клуба. 
Подробное условие можно найти в файлах `assets/assignment.docx` или `assets/assignment.pdf`.


## Обзор архитектуры

Верхнеуровнево архитектура программы такова (на картинке показаны зависимости между разными слоями системы)
![](assets/arch-view.png)

Была попытка реализовать слоистую архитектуру со слоями бизнес-логики, взаимодействия с данными и логики ввода/вывода.

### Представление событий
Каждое событие в системе явялется либо внутренным, либо внешним. В зависимости от типа может различаться логика взаимодействия с ними.

В коде события представлены в виде структур, хранящих данные для обработки.
Регистрация событий осуществляется в файле `events/events.def` с помощью макросов 
```COMPUTER_CLUB_INTERNAL_EVENT(Id, Name) ``` и ```COMPUTER_CLUB_EXTERNAL_EVENT(Id, Name)```
Регистрация событий нужна для ассоциирования идентификатора события с его названием.

### Слой бизнес-логики
Бизенс-логика в коде реализуется через функции `Handle##EventName##Event` именно они являются конечными точками по обработке событий. 
Слой бизнес-логики взамодействует со слоем данных. 
Также слой бизнес-логики может вызывать новые события (подразумевается, что вызывать можно только внутрение события, хотя в коде это никак не выражено).

### Слой взаимодействия с данными

Взаимодействие с данным осуществляется с помощью сущеностей
- `Accountant`: считает статистику (сколько времени было проведено за каждым столом) и занимается генерацией отчета по собранной статистике
- `ClientRegistry`: следит за регистрацией поситителей в клубе и очередями
- `TableRegistry`: следит за столами (прикрепляет(открепляет) клиентов к(от) столам(-ов))

### Слой ввода/вывода

Логика ввода/вывода реализована через методы `Parse##EventName##Event` и `Serialize##EventName##Event`.
Причем сериализации подвергаются все события, а парсингу только внешние.


## Сбора и запуск

Для сборки проекта испольуется CMake. В проекте присутсвтует несколько целей для сборки. Нас интересуют `yadro_computer_club`и `yadro_computer_club_tests`.

```shell
cmake -S . -B cmake-build-release -DCMAKE_BUILD_TYPE=Release
cd cmake-build-release
cmake --build . --target yadro_computer_club
cmake --build . --target yadro_computer_club_tests
```


### `yadro_computer_club`
Синтаксис использования следующий
```shell
yadro_computer_club <input>
```
где под `<input>` понимается путь к входному файлу; 
данные в файле должны быть корректны (в противном случае программа укажет на некорректную строчку и завершится).


### `yadro_computer_club_tests`
Синтаксис использования следующий
```shell
yadro_computer_club_tests
```